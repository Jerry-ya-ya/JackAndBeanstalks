<div class="admin-dashboard">
    <div class="dashboard-header">
        <h2>ç®¡ç†å“¡å¾Œå°</h2>
        <p class="subtitle">ç”¨æˆ¶ç®¡ç†èˆ‡æ¬Šé™æ§åˆ¶</p>
    </div>
    <!-- è¨Šæ¯æç¤º -->
     <div *ngIf="message" class="message-container">
        <div class="message success">
            <span class="message-icon">âœ“</span>
            <span>{{ message }}</span>
        </div>
    </div>
    
    <!-- çµ±è¨ˆå¡ç‰‡ -->
    <div class="stats-container">
        <div class="stat-card">
            <div class="stat-number">{{ users.length }}</div>
            <div class="stat-label">ç¸½ç”¨æˆ¶æ•¸</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ getUsersByRole('admin').length }}</div>
            <div class="stat-label">ç®¡ç†å“¡</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ getUsersByRole('user').length }}</div>
            <div class="stat-label">ä¸€èˆ¬ç”¨æˆ¶</div>
        </div>
    </div>
    <!-- ç”¨æˆ¶è¡¨æ ¼ -->
    <div class="table-container">
        <div class="table-header">
            <h3>ç”¨æˆ¶åˆ—è¡¨</h3>
            <div class="table-actions">
                <input 
                type="text" 
                placeholder="æœå°‹ç”¨æˆ¶..." 
                [(ngModel)]="searchTerm"
                (ngModelChange)="filterUsers()"
                class="search-input"
                >
            </div>
        </div>
        <div class="table-wrapper">
            <table class="user-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>å¸³è™Ÿ</th>
                        <th>æš±ç¨±</th>
                        <th>Email</th>
                        <th>è§’è‰²</th>
                        <th>è¨»å†Šæ™‚é–“</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let user of filteredUsers" class="user-row">
                        <td class="user-id">{{ user.id }}</td>
                        <td class="username">
                            <div class="user-info">
                                <img class="user-avatar" [src]="'http://localhost:5000/'+ user.avatar_url"/>
                                <span>{{ user.username }}</span>
                            </div>
                        </td>
                        <td>{{ user.nickname || '-' }}</td>
                        <td class="email">{{ user.email }}</td>
                        <td>
                            <span class="role-badge" [class]="'role-' + user.role">
                                {{ getRoleDisplayName(user.role) }}
                            </span>
                        </td>
                        <td class="created-at">{{ formatDate(user.created_at) }}</td>
                        <td class="actions">
                            <!-- æ™‰å‡ -->
                            <button 
                              *ngIf="user.role === 'user'" 
                              (click)="promote(user.id)"
                              class="promote-btn"
                              [disabled]="promotingUserId === user.id"
                            >
                                <span *ngIf="promotingUserId !== user.id">æ™‰å‡ç‚ºç®¡ç†å“¡</span>
                                <span *ngIf="promotingUserId === user.id" class="loading">è™•ç†ä¸­...</span>
                            </button>
                            <!-- é™ç´š -->
                            <button 
                              *ngIf="user.role === 'admin'" 
                              (click)="demote(user.id)"
                              class="demote-btn"
                              [disabled]="demotingUserId === user.id"
                            >
                                <span *ngIf="demotingUserId !== user.id">é™ç´šç‚ºä¸€èˆ¬ç”¨æˆ¶</span>
                                <span *ngIf="demotingUserId === user.id" class="loading">è™•ç†ä¸­...</span>
                            </button>
                            <!-- æœ€é«˜ç®¡ç†å“¡ -->
                            <span *ngIf="user.role === 'superadmin'" class="no-action">æœ€é«˜ç®¡ç†å“¡</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- ç©ºç‹€æ…‹ -->
        <div *ngIf="filteredUsers.length === 0" class="empty-state">
            <div class="empty-icon">ğŸ‘¥</div>
            <p>æ²’æœ‰æ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„ç”¨æˆ¶</p>
        </div>
    </div>
</div>